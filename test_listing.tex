%!TEX options = --shell-escape
%!TEX program = pdflatex
\documentclass{article}
% \usepackage{showframe}
\usepackage{xcolor}
\usepackage{lmodern}
\renewcommand*\familydefault{\sfdefault}
\usepackage[left=1in,textwidth=26pc,marginparsep=2pc,marginparwidth=12pc]{geometry}
\usepackage[newfloat]{minted}
\setminted{bgcolor=cyan}
\usepackage{caption}
\usepackage{mcaption}
\captionsetup{format=plain}
\setminted{linenos,frame=lines, framesep=\fboxsep, rulecolor=\color{gray!40}}

\definecolor{dhscodebg}{rgb}{0.95,0.95,0.95}

\makeatletter
\patchcmd{\minted@colorbg}{\noindent}{\medskip\noindent}{}{}
\apptocmd{\endminted@colorbg}{\par\medskip\vspace{-.7\baselineskip}}{}{}
\makeatother

\begin{filecontents}{some.txt}
a
d
d
b
c
d
\end{filecontents}

\begin{document}

\begin{listing}
\begin{margincap}
\inputminted[startinline]{php}{imports/login_1.php}
\caption[asdf]{asdfasdfasdfasfdasdf }
\label{lst:login_query}
\end{margincap}
\end{listing}



\begin{listing}
\begin{margincap}
\inputminted{text}{some.txt}
\caption{A long, long text in the margin. A long, long text in the margin. A long, long text in the margin. A long, long text in the margin and more and more.}
\end{margincap}
\end{listing}

\begin{listing}
\begin{margincap}
\begin{minted}{text}
%% LaTeX2e file `some.txt'
%% generated by the `filecontents' environment
%% from source `test_listing' on 2016/06/24.
%%
a
d
d
b
c
d
\end{minted}
\caption{A long, long text in the margin. A long, long text in the margin. A long, long text in the margin. A long, long text in the margin and more and more.}
\end{margincap}
\end{listing}



\end{document}